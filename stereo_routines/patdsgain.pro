 PRO PATDSGAIN,F,IPA,IFILT,GTDSC,GTDS,PHASE;;	THIS ROUTINE COMPUTES GAINS OF THE TDS AND PREAMP;	THE INPUT IS TAKEN FROM THE PREAMP INPUT, ;	ANTENNA IMPEDANCE NOT TAKEN INTO ACCOUNT;;	COMPLEX CDEN,GTDSC,Y4,Z4;	REAL CSF(4),CSB(4);;	COMMON /ANTENNZ/ RANT,RBASE,CANT,CBASE;;	DATA R1,R2,RF/ 3.3E3, 3.3E3, 3.3E3/;	DATA R4,C4,R5 / 12.1E3, 47.E-12, 10.E3/;;	DATA CSF /180.E-12, 400.E-12, 1650.E-12, 6600.E-12/;	DATA CSB /820.E-12, 1500.E-12, 6420.E-12, .0278E-6/;	CSF = [180.E-12, 400.E-12, 1650.E-12, 6600.E-12]	CSB = [820.E-12, 1500.E-12, 6420.E-12, .0278E-6]	TWOPI = 6.28318531	RIN = 150.E6;	CSTRAY = 3.E-12		CSTRAY = 5.8E-12	CCP = 100.E-12	ROPM = 15.E3	COPM = 1.E-6	ROUT = 220.	COUT = 3.3E-9	RSER = 100.	RLD = [3.33E3, 4.08E3, 5.25E3]	R1 = 3.3E3	R2 = 3.3E3	RF = 3.3E3	R4 = 12.1E3	C4 = 47.E-12	R5 = 10.E3;	RT1 = 22.1E3;	RT2 = 22.1E3;	CT = .1E-6
;	12 mar 2005 back to old R's, new C
	RT1 = 3.32E3	RT2 = 3.32E3	CT = .57E-6
		CCABLE = 135.E-12	R7 = 15.	R9 = 1.E4	C10 = .01E-6;	W = TWOPI*F;;		PREAMP GAIN TO INPUT TO ROUT = 220 OHMS;	YIN = COMPLEX(1./RIN,W*CSTRAY)	Z1 = 1./YIN + COMPLEX(RSER,-1./W/CCP)	ZOPM = COMPLEX(ROPM,-1./W/COPM)	GPAC = (1./(YIN*Z1))*(ROPM/ZOPM)*6.67	COUTE = COUT + CCABLE;;	ANALOGUE BOARD WITH PREAMP LOADING;	RLOAD = RLD(IPA-1)	Y4 = COMPLEX(1./R4, W*C4)	GTDSC = GPAC/(ROUT*COMPLEX(1./RLOAD,W*COUTE)+1.)/R5/Y4	Z4 = 1./Y4	if (ifilt ge 0) and (ifilt le 3) then begin	  CF = CSF(IFILT)	  CB = CSB(IFILT)	  CDEN = -COMPLEX(R1/RF-(W^2)*CF*CB*R1*R2, W*CF*(R2+R1*R2/RF + R1))	  GTDSC = GTDSC/CDEN	endif;;	ON TDS A/D BOARD;	GTDSC = GTDSC*RT2/COMPLEX(RT1,-1./(W*CT))	Y910 = COMPLEX(1./R9,W*C10)	GTDSC = GTDSC/(1. + R7*Y910)
	GTDSC = -GTDSC
;	PHASE = 57.2957795*ATAN(IMAGINARY(GTDSC),FLOAT(GTDSC))	GTDS = ABS(GTDSC);	RETURN	END